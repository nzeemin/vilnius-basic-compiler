-q
----------------------------------------------------------------------
10 CLS 
20 WIDTH 40,0
30 POKE &O177560,0
40 ? AT(1,10);"IF...THEN...ELSE...(описание формата)."
50 ? AT(22,5);"Имя файла: IF1F"
60 GOSUB 2000
70 DIM B%(15,4),U7$(15)
80 DIM A%(7,2),WW$(3),V$(9)
90 CH%=0
100 N%=0
110 NZ%=0
120 CLS 
130 WW$(1)="УДАЛИТЬ"
140 WW$(2)="ВСТАВИТЬ"
150 WW$(3)="ЗАМЕНИТЬ"
160 V$(1)=") "
170 V$(2)=", "
180 V$(3)="F "
190 V$(4)="H "
200 V$(5)="$ "
210 V$(6)="= "
220 V$(7)="( "
230 V$(8)="O "
240 V$(9)="0 "
250 RESTORE 1160
260 FOR I%=1 TO 5
270 READ A%(I%,1),A%(I%,2)
280 N%=N%+A%(I%,1)
290 NEXT 
300 RESTORE 1170  
310 FOR I%=1 TO N%
320 READ B%(I%,1),B%(I%,2),B%(I%,3),B%(I%,4),U7$(I%)
330 NEXT 
340 GOSUB 2110
350 GOSUB 1900
360 NZ%=NZ%+1
370 ? AT(37,21);NZ%
380 X8%=A%(NZ%,2)
390 X9%=A%(NZ%,2)+A%(NZ%,1)-1
400 ? AT(0,0);"╙";STRING$(25,"╣");AT(26,0);"╚╣ё"
410 FOR I%=1 TO 7
420 ? AT(0,I%);"╥";AT(26,I%);"╥ ╥"
430 NEXT 
440 ? AT(0,8);"╕";STRING$(25,"╣");AT(26,8);"║╣╧"
450 ON NZ% GOSUB 1580,1650,1720,1770,1820
460 X1%=1
470 X2%=5
480 R%=X1%
490 RX%=X1%
500 GOSUB 1180
510 FOR I%=X8% TO X9%
520 IF R%<>B%(I%,1) THEN 530 ELSE 560
530 IF I%=X9% THEN GOSUB 2140 ELSE 550
540 GOTO 500
550 NEXT 
560 X7%=I%
570 K1%=B%(I%,1)
580 B%(I%,1)=0
590 Y1%=1
600 Y2%=25
610 GOSUB 1450 
620 IF R%=B%(X7%,2) THEN 660
630 GOSUB 2140
640 GOSUB 1470
650 GOTO 620 
660 K2%=B%(X7%,2)
670 X1%=5
680 X2%=7
690 ? AT(30,4)"╙╣╣╣╣╣╣╣╣ё"
700 ? AT(30,5)"╥";WW$(1);" ╥"
710 ? AT(30,6)"╥";WW$(2);"╥"
720 ? AT(30,7)"╥";WW$(3);"╥"
730 ? AT(30,8)"╕╣╣╣╣╣╣╣╣╧"
740 R%=X1%
750 RX%=X1%
760 GOSUB 1180
770 IF B%(X7%,3)=R%-5 THEN 800
780 GOSUB 2140
790 GOTO 760
800 IF B%(X7%,3)=0 THEN 920
810 X1%=10
820 X2%=18
830 R%=X1%
840 RX%=X1%
850 FOR I%=1 TO 9
860 ? AT(31,I%+9);V$(I%)
870 NEXT 
880 GOSUB 1180
890 IF B%(X7%,4)=R%-9 THEN 920
900 GOSUB 2140
910 GOTO 880
920 GOSUB 2090
930 FOR I%=1 TO 3100
940 BEEP 
950 NEXT 
960 B%(X7%,1)=0
970 A%(NZ%,1)=A%(NZ%,1)-1
980 FOR I%=4 TO 19
990 ? AT(30,I%);SPC(10);
1000 NEXT 
1010 IF A%(NZ%,1)<>0 GOTO 460
1020 IF NZ%=5 THEN 1050
1030 GOSUB 2000
1040 GOTO 360
1050 GOSUB 2000
1060 CLS 
1065 ? AT(9,2)"Штрафные очки-";CH%;
1066 ? AT(2,6)"Если хотите еще раз проверить свои"AT(2,7)"знания, введите команду RUN."
1067 ? AT(2,9)"Более сложные задания Вам будут"AT(2,10)"предложены в программе IF2S."
1068 ? AT(2,11)"Для этого введите команду:"AT(9,13)"LOAD ";CHR$(34);"IF2S";CHR$(34);",R"
1070 IF CH%=>15 THEN 1130
1080 IF CH%=>7 THEN 1110
1090 ? AT(9,3)"О Т Л И Ч Н О  !"
1100 GOTO 1140
1110 ? AT(9,3)"ПОСРЕДСТВЕННО."
1120 GOTO 1140
1130 ? AT(9,3)"ОЧЕНЬ МНОГО, ОЧЕНЬ.";AT(2,4)"Повторите теоретический материал."
1140 POKE &O177560,&O100
1145 LOAD "MENU3",R
1150 END 
1160 DATA 1,1,3,2,1,5,1,6,3,7
1170 DATA 2,12,2,4,"H",2,17,1,6,"=",3,17,2,6,"=",4,5,2,3,"F",2,7,1,5,"$",1,10,1,5,"$",3,18,0,0," ",4,8,0,0,"=B THEN 60 ",5,12,2,8,"O"
1180 IF X1%=1  GOTO 1240   ELSE IF X1%=10 GOTO 1290
1190 ? AT(31,RX%);WW$(RX%-4);AT(B%(X7%,2),K1%);
1200 COLOR 2,2,8
1210 ? AT(31,R%);WW$(R%-4);AT(B%(X7%,2),K1%);
1220 COLOR 8,2,2
1230 GOTO 1330 
1240 ? AT(27,RX%);" ";
1250 COLOR 2,2,8
1260 ? AT(27,R%);" ";AT(27,R%);
1270 COLOR 8,2,2
1280 GOTO 1330
1290 ? AT(31,RX%);V$(RX%-9);AT(B%(X7%,2),K1%);
1300 COLOR 2,2,8
1310 ? AT(31,R%);V$(R%-9);AT(B%(X7%,2),K1%);
1320 COLOR 8,2,2
1330 RX%=R%
1340 GOSUB 2170
1350 IF W%=13 THEN 1430
1360 IF A1%(1)=27 AND A1%(2)=65 THEN 1390
1370 IF A1%(1)=27 AND A1%(2)=66 THEN 1410
1380 GOTO 1340  
1390 IF R%<>X1% THEN R%=R%-1 ELSE R%=X2%
1400 GOTO 1180  
1410 IF R%<>X2% THEN R%=R%+1 ELSE R%=X1%
1420 GOTO 1180  
1430 IF X1%=1 THEN ? AT(27,R%);" "
1440 RETURN 
1450 RX%=R%
1460 R%=Y1%
1470 ? AT(R%,RX%);
1480 GOSUB 2170
1490 IF W%=13 THEN 1570
1500 IF A1%(1)=27 AND A1%(2)=68 THEN 1530
1510 IF A1%(1)=27 AND A1%(2)=67 THEN 1550
1520 GOTO 1480 
1530 IF R%<>Y1% THEN R%=R%-1 ELSE R%=Y2%
1540 GOTO 1470 
1550 IF R%<>Y2% THEN R%=R%+1 ELSE R%=Y1%
1560 GOTO 1470 
1570 RETURN 
1580 ? AT(1,1)"10 INPUT A,B"
1590 ? AT(1,2)"20 IF A>B TNEN 50 ELSE 30"
1600 ? AT(1,3)"30 PRINT B
1610 ? AT(1,4)"40 STOP"
1620 ? AT(1,5)"50 PRINT A"
1630 ? AT(1,6)"60 END"
1640 RETURN 
1650 ? AT(1,1)"10 INPUT A,B"
1660 ? AT(1,2)"20 IF A>B THEN Y A"
1670 ? AT(1,3)"30 IF A=B THEN Y>0"
1680 ? AT(1,4)"40 IG A<B THEN Y=B
1690 ? AT(1,5)"50 PRINT Y"
1700 ? AT(1,6)"60 END"
1710 RETURN 
1720 ? AT(1,1)"1 INPUT A$"
1730 ? AT(1,2)"2 IF A =";CHR$(34);"%";CHR$(34);" THEN 3 ELSE 1"
1740 ? AT(1,3)"3 PRINT A$"
1750 ? AT(1,4)"4 END"
1760 RETURN 
1770 ? AT(1,1)"1 INPUT A "
1780 ? AT(1,2)"2 IF A$=";CHR$(34);";";CHR$(34);" THEN 1 ELSE 3"
1790 ? AT(1,3)"3 PRINT A$"
1800 ? AT(1,4)"4 END"
1810 RETURN 
1820 ? AT(1,1)"10 A=2.3"
1830 ? AT(1,2);"20 INPUT B"
1840 ? AT(1,3)"30 IF A>B GOTO 60A"
1850 ? AT(1,4)"40 IF A:=B THEN 60"
1860 ? AT(1,5)"50 IF A<B G0TO 20"
1870 ? AT(1,6)"60 PRINT A;B"
1880 ? AT(1,7)"70 END"
1890 RETURN 
1900 ? AT(0,9)"Формат:"
1910 ? AT(2,10)"IF <УСЛ.> THEN <АРГ.>"
1920 ? AT(4,11)"[ELSE <АРГ.>]"
1930 ? AT(0,13)"<УСЛ.>:=целое  выражение,"
1940 ? AT(0,14)"определяющее условие."
1950 ? AT(0,15)"<АРГ.>::=номер существующей"
1960 ? AT(0,16)"строки или оператор БЕЙСИКа."
1970 ? AT(0,18)"Вместо слова THEN можно"
1980 ? AT(0,19)"использовать GOTO."
1990 RETURN 
2000 ? AT(4,22);"Нажмите клавишу ПРОБЕЛ.";
2010 IF INP(&O177560,&O200) THEN 2020 ELSE 2010
2020 W%=PEEK(&O177562)
2030 IF W%=32 THEN 2040 ELSE 2010
2040 FOR J%=1 TO 7
2050 ? AT(1,J%);SPC(25)
2060 NEXT J%
2070 ? AT(4,22);SPC(25)
2080 RETURN 
2090 ? AT(K2%,K1%);U7$(X7%);
2100 RETURN 
2110 ? AT(30,21)"Задание"
2115 ? AT(31,22)"IF1F"
2120 ? AT(35,0)"ШТРАФ";AT(35,1)"╙╣╣╣ё";AT(35,2);"╥   ╥";AT(35,3);"╕╣╣╣╧"
2130 RETURN 
2140 CH%=CH%+1
2150 ? AT(36,2)CH%;AT(39,2)"╥";
2160 RETURN 
2170 FOR I%=1 TO 2
2180 IF INP(&O177560,&O200) THEN 2190 ELSE 2180
2190 W%=PEEK(&O177562)
2200 IF W%=13 AND I%=1 THEN 2240
2210 IF W%=27 AND I%=1 THEN A1%(1)=W% ELSE A1%(2)=W%
2220 IF W%<>27 AND I%=1 THEN I%=2
2230 NEXT I%
2240 RETURN 
